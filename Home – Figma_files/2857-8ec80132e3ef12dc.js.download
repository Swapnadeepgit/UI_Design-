!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e6603fa7-90de-4b9c-9c1d-2915dbcb5bae",e._sentryDebugIdIdentifier="sentry-dbid-e6603fa7-90de-4b9c-9c1d-2915dbcb5bae")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2857],{61148:function(e,t,a){a.d(t,{Z:function(){return n}});var i=a(2265),d=a(10541);function n(e){let{postMessage:t,forceMetadata:a}=e,{setUserId:n,setMetadata:s,setTrack:o,setUserIdAuth:r,metadataRequest:l,setMetadataRequest:c,addMetadata:u,setQuestion:v,setLocalizationData:g,setIsConversationUrlVisible:p,setConversationId:h,setChatSessionDuration:m,setStartNewConversation:f,addMetadataRequestKey:E,clearMetadataRequestKeys:w,setWidgetCornerPosition:b,setMobile:x,conversationId:M,addSdkMessage:I}=(0,d.K)(e=>({setUserId:e.setUserId,setMetadata:e.setMetadata,setTrack:e.setTrack,setUserIdAuth:e.setUserIdAuth,metadataRequest:e.metadataRequest,setMetadataRequest:e.setMetadataRequest,addMetadata:e.addMetadata,setQuestion:e.setQuestion,setLocalizationData:e.setLocalizationData,setIsConversationUrlVisible:e.setIsConversationUrlVisible,setConversationId:e.setConversationId,setChatSessionDuration:e.setChatSessionDuration,setStartNewConversation:e.setStartNewConversation,addMetadataRequestKey:e.addMetadataRequestKey,clearMetadataRequestKeys:e.clearMetadataRequestKeys,setWidgetCornerPosition:e.setWidgetCornerPosition,setMobile:e.setMobile,conversationId:e.conversationId,addSdkMessage:e.addSdkMessage})),y=(0,i.useRef)(l);return(0,i.useEffect)(()=>{y.current=l,"loading"==l.status&&t({type:"REQUEST_METADATA",payload:{subtype:l.subtype,params:l.params}},"*")},[l]),(0,i.useEffect)(()=>{M&&w()},[M]),(0,i.useEffect)(()=>{o(e=>{t({type:"USER_ACTION",payload:e},"*")}),window.addEventListener("message",e=>{var i,d,o,l,w,M,C,N,R,A,D,_,S,T,k,O,j,P,U,H,W,V,q,G,L,z;if(null===(i=e.data)||void 0===i?void 0:i.coord){let a=e.data.coord;if(!a.x||!a.y)return;let i=document.getElementById("duet-widget"),d=document.elementFromPoint(a.x,a.y);d&&i&&i.contains(d)?t({type:"DECAGON_HOVER"},"*"):t({type:"DECAGON_UNHOVER"},"*")}else if(null===(d=e.data)||void 0===d?void 0:d.metadata)s({...e.data.metadata,...null!=a?a:{}});else if(null===(o=e.data)||void 0===o?void 0:o.addMetadata)u(e.data.addMetadata);else if(null===(l=e.data)||void 0===l?void 0:l.userId)n(e.data.userId);else if((null===(w=e.data)||void 0===w?void 0:w.initialUserMessage)!==void 0)v(e.data.initialUserMessage);else if((null===(M=e.data)||void 0===M?void 0:M.userIdAuth)!==void 0)r(e.data.userIdAuth.signature,e.data.userIdAuth.epoch);else if((null===(C=e.data)||void 0===C?void 0:C.metadataRequestResult)!==void 0){let t=y.current,a=t.subtype,i=e.data.metadataRequestResult,d="user_".concat(a);if(i.ok){let e=i.data[a],n=null!==(U=i.data.persist)&&void 0!==U&&U,s=null!==(H=i.data.persistenceLevel)&&void 0!==H?H:"PERMANENT";u({[d]:e,decagon_redacted_fields:n&&"PERMANENT"===s?[]:[d]}),c({...t,status:"success",persist:n,persistenceLevel:n?s:void 0}),n&&"PERMANENT"!==s&&E(d)}else u({["user_".concat(a,"_error")]:i.error}),c({...t,status:"error"})}else(null===(N=e.data)||void 0===N?void 0:N.triggerMessage)?(u({triggerMessage:null===(W=e.data)||void 0===W?void 0:W.triggerMessage}),(null===(V=e.data)||void 0===V?void 0:V.isProactive)&&u({proactiveMessage:null===(q=e.data)||void 0===q?void 0:q.triggerMessage})):(null===(R=e.data)||void 0===R?void 0:R.proactiveMessage)?u({proactiveMessage:null===(G=e.data)||void 0===G?void 0:G.proactiveMessage}):(null===(A=e.data)||void 0===A?void 0:A.localizationData)?g(e.data.localizationData):(null===(D=e.data)||void 0===D?void 0:D.isConversationUrlVisible)!==void 0?p(e.data.isConversationUrlVisible):(null===(_=e.data)||void 0===_?void 0:_.chatSessionDuration)!==void 0?m(e.data.chatSessionDuration):(null===(S=e.data)||void 0===S?void 0:S.startNewConversation)!==void 0?f(e.data.startNewConversation):(null===(T=e.data)||void 0===T?void 0:T.conversationId)!==void 0?h(null===(L=e.data)||void 0===L?void 0:L.conversationId):(null===(k=e.data)||void 0===k?void 0:k.widgetCornerPosition)!==void 0?b(e.data.widgetCornerPosition):(null===(O=e.data)||void 0===O?void 0:O.isMobile)!==void 0?x(e.data.isMobile):(null===(j=e.data)||void 0===j?void 0:j.sdkMessage)!==void 0?I(String(e.data.sdkMessage)):(null===(P=e.data)||void 0===P?void 0:P.theme)!==void 0&&document.documentElement.setAttribute("data-appearance",null===(z=e.data.theme)||void 0===z?void 0:z.appearance)}),t({type:"DECAGON_LOADED"},"*")},[]),null}},32857:function(e,t,a){a.r(t),a.d(t,{EmbeddableWidget:function(){return b},default:function(){return p}});var i=a(57437),d=a(2265),n=a(91434),s=a(33145),o=a(10541),r=a(81230),l=a(80502),c=a(61340),u=a(79067),v=a(50510);function g(e){var t,a,g;let{theme:p,closedWidth:h,closedHeight:m,setMinimized:f,namespace:E,widgetSettings:w}=e,b=(0,d.useRef)(!0),x=(0,d.useRef)(!1),M={width:null!=h?h:"large"===p?190:66,height:null!=m?m:"large"===p?54:66,borderRadius:(null==w?void 0:w.squareChatIcon)?12:33},[I,y]=(0,d.useState)({width:void 0,height:void 0}),[C,N]=(0,n.q_)(()=>M),{isExpanded:R,setExpanded:A,track:D,localizationData:_,setIsExpandAnimating:S,setSurveyOpen:T,isMobile:k}=(0,o.K)(e=>({isExpanded:e.isExpanded,setExpanded:e.setExpanded,track:e.track,localizationData:e.localizationData,setIsExpandAnimating:e.setIsExpandAnimating,setSurveyOpen:e.setSurveyOpen,isMobile:e.isMobile}));return((0,d.useEffect)(()=>{function e(){y({width:window.innerWidth,height:window.innerHeight})}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,d.useLayoutEffect)(()=>{var e;if(b.current&&(b.current=!1,!R))return;let t=r.$7,a=null!==(e=null==w?void 0:w.openHeight)&&void 0!==e?e:r.R$,i={width:k?window.innerWidth:Math.min(window.innerWidth-40,t),height:k?window.innerHeight:Math.min(window.innerHeight-40,a),borderRadius:"ramp"===E||k?0:12},d=C.width.get(),n=C.height.get();R||M.width==d||M.height==n?R&&i.width!=d&&i.height!=n&&(N.start({from:M,to:i,config:{mass:1,friction:33,tension:500},onStart:()=>{S(!0)},onRest:()=>{S(!1)}}),x.current||(D({eventName:"DUET_INITIALIZE"}),x.current=!0)):(N.start({to:M,from:i,config:{mass:1,friction:33,tension:400},onStart:()=>{S(!0)},onRest:()=>{S(!1)}}),x.current&&(D({eventName:"DUET_DEINITIALIZE"}),x.current=!1))},[R,R?I:null]),R)?(0,i.jsx)(n.q.div,{className:"flex flex-col overflow-hidden bg-white team-theme-widget relative ".concat(k?"":"mr-5 mb-5 all-shadow"),style:{...C},role:"dialog","aria-label":"Chat interface","aria-modal":"true",tabIndex:0,children:(0,i.jsx)(u.Z,{onClose:e=>{A(!1),T(!1),f&&f(!!e)}})},"widget"):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(n.q.div,{className:"mr-5 mb-5 overflow-hidden max-h-screen rounded-full flex items-center justify-center shadow-lg cursor-pointer hover:scale-110 team-theme-widget widget-closed team-theme-bg ".concat("substack"===E&&k?"origin-bottom-right scale-75":""),onClick:()=>{A(!0)},style:{transition:"transform .3s",...C},onKeyDown:e=>("Enter"===e.code||"Space"===e.code)&&A(!0),tabIndex:1,role:"button","aria-label":"Open Chat Agent","aria-expanded":"false",children:"large"===p?(0,i.jsxs)("div",{className:"".concat(["360_payments_capital","marriott"].includes(E)?"text-black":"text-white"," font-semibold flex items-center"),"aria-label":(null==_?void 0:_.widgetText)||(null==w?void 0:w.defaultText)||"Ask a question",children:[(null==w?void 0:w.chatIconUrl)?(0,i.jsx)(s.default,{src:(0,v.np)(w.chatIconUrl),alt:"".concat(E," chat icon"),height:28,width:28,className:"mr-2.5","aria-hidden":"true",unoptimized:!0}):(0,i.jsx)(c.Z,{className:"mr-2.5","aria-hidden":"true"}),(null==_?void 0:_.widgetText)||(null==w?void 0:w.defaultText)||"Ask a question"]}):"small"===p?(0,i.jsx)("div",{className:"text-white font-semibold text-3xl","aria-label":"Chat message icon",children:(0,i.jsx)(c.Z,{"aria-hidden":"true"})}):(0,i.jsx)("div",{className:null!==(t=null==w?void 0:w.padding)&&void 0!==t?t:"",children:(0,i.jsx)(s.default,{src:(null==w?void 0:w.chatIconUrl)?(0,v.np)(w.chatIconUrl):(0,v.np)("/avatars/".concat((0,l.IA)(E),".png")),alt:"".concat(E," chat avatar"),height:null!==(a=null==w?void 0:w.defaultChatIconHeight)&&void 0!==a?a:42,width:null!==(g=null==w?void 0:w.defaultChatIconWidth)&&void 0!==g?g:42,quality:88,className:"widget-avatar","aria-hidden":"true",unoptimized:!0})})},"widget")})}function p(e){var t,a,n,s,r;let{setNamespace:c,setTeamId:u,namespace:p,widgetPreferences:h,setWidgetPreferences:m,isMobile:f,setMobile:E,widgetTheme:w}=(0,o.K)(e=>({setNamespace:e.setNamespace,setTeamId:e.setTeamId,namespace:e.namespace,widgetPreferences:e.widgetPreferences,setWidgetPreferences:e.setWidgetPreferences,isMobile:e.isMobile,setMobile:e.setMobile,widgetTheme:e.widgetTheme})),b=p||e.namespace;(0,d.useEffect)(()=>{(0,v.LE)((0,l.IA)(p),"BASE",w).then(e=>{"error"in e||m(e)})},[p,w]),(0,d.useEffect)(()=>{c(e.namespace),u(e.teamId);let t=navigator.userAgent||navigator.vendor;(/android/i.test(t)||/iPad|iPhone|iPod/.test(t))&&E(!0)},[e.namespace,e.teamId]);let x="logo";return(h&&(x=(null===(n=h.settings)||void 0===n?void 0:n.theme)==="dynamic"?f?"small":"large":null!==(r=null===(s=h.settings)||void 0===s?void 0:s.theme)&&void 0!==r?r:"logo"),h)?(0,i.jsx)(g,{theme:x,closedWidth:null==h?void 0:null===(t=h.settings)||void 0===t?void 0:t.closedWidth,closedHeight:null==h?void 0:null===(a=h.settings)||void 0===a?void 0:a.closedHeight,setMinimized:e.setMinimized,namespace:b,widgetSettings:null==h?void 0:h.settings},"".concat(x,"-").concat(b)):null}var h=a(49638);function m(e){let{metadata:t,hasBeenExpanded:a,setExpanded:n,track:s}=(0,o.K)(e=>({metadata:e.metadata,hasBeenExpanded:e.hasBeenExpanded,setExpanded:e.setExpanded,track:e.track})),[r,l]=(0,d.useState)(!0),c=(0,d.useRef)(null),u=!!t&&!!t.proactiveMessage,v=!e.isWidgetHidden&&r&&!a&&u;return(0,d.useEffect)(()=>{if(c.current&&v){let t=c.current.clientHeight+parseInt(window.getComputedStyle(c.current).marginTop)+parseInt(window.getComputedStyle(c.current).marginBottom),a=c.current.clientWidth+parseInt(window.getComputedStyle(c.current).marginLeft)+parseInt(window.getComputedStyle(c.current).marginRight);parent.postMessage({type:"DECAGON_PROACTIVE_MESSAGE",action:"open",isHidden:e.isWidgetHidden,proactiveMessageHeight:t,proactiveMessageWidth:a},"*")}else parent.postMessage({type:"DECAGON_PROACTIVE_MESSAGE",isHidden:e.isWidgetHidden,action:"close"},"*")},[v,e.isWidgetHidden]),(0,i.jsx)(i.Fragment,{children:v&&r&&(0,i.jsx)("div",{ref:c,className:"absolute bottom-full my-4 mx-5 text-slate-700 ".concat("bottom-left"===e.cornerPosition?"left-0":"right-0"),style:{width:"max-content",maxWidth:300},children:(0,i.jsxs)("div",{id:"proactive-message-bubble",className:"bg-slate-200 widget-agent-chat-bubble rounded-lg relative group",style:{width:"max-content",maxWidth:300},children:[(0,i.jsx)("div",{className:"absolute top-0 right-0 mt-[-12px] mr-[-12px] transition-opacity duration-300 opacity-0 group-hover:opacity-100 cursor-pointer bg-opacity-10 hover:bg-opacity-20 bg-black flex justify-center items-center w-8 h-8 rounded-full",onClick:()=>{l(!1),s({eventName:"DUET_USER_DISMISSED_PROACTIVE"})},role:"button","aria-label":"Close",children:(0,i.jsx)(h.Z,{className:"text-white"})}),(0,i.jsx)("div",{className:"break-words py-4 px-5 whitespace-pre-wrap cursor-pointer",onClick:()=>n(!0),children:null==t?void 0:t.proactiveMessage})]})})})}var f=a(81770),E=a(61994),w=a(61148);function b(e){var t;let[a,n]=(0,d.useState)(null!==(t=e.hiddenMode)&&void 0!==t&&t),[s,r]=(0,d.useState)(!1),{isExpanded:l,setExpanded:c,track:u,widgetCornerPosition:v,setWidgetCornerPosition:g}=(0,o.K)(e=>({isExpanded:e.isExpanded,setExpanded:e.setExpanded,track:e.track,widgetCornerPosition:e.widgetCornerPosition,setWidgetCornerPosition:e.setWidgetCornerPosition})),h=null!=v?v:"bottom-right",b=a&&!s&&!l;return(0,d.useEffect)(()=>{window.addEventListener("message",e=>{var t,a,i;(null===(t=e.data)||void 0===t?void 0:t.isVisible)!==void 0?(c(!!e.data.isVisible),r(!1)):(null===(a=e.data)||void 0===a?void 0:a.hiddenMode)!==void 0?n(!!e.data.hiddenMode):(null===(i=e.data)||void 0===i?void 0:i.widgetCornerPosition)!==void 0&&g(e.data.widgetCornerPosition)})},[]),(0,d.useEffect)(()=>{l?(r(!1),parent.postMessage({type:"DECAGON_ACTIVE"},"*"),parent.postMessage({type:"DECAGON_HOVER"},"*")):(parent.postMessage({type:"DECAGON_INACTIVE",isHidden:b},"*"),parent.postMessage({type:"DECAGON_UNHOVER"},"*"))},[l,b]),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)(w.Z,{postMessage:(e,t)=>parent.postMessage(e,t)}),e.buildModeSettings&&(0,i.jsx)("div",{className:(0,E.Z)("absolute bottom-[20px] right-[450px] w-96 z-50 transition-all duration-300",l?"opacity-100 translate-x-0 translate-y-0":"opacity-0 translate-x-4 translate-y-4 hidden"),children:e.buildModeSettings}),(0,i.jsxs)("div",{className:"absolute bottom-0 ".concat("bottom-left"===h?"left-0 pl-5":"right-0"," z-50"),id:"duet-widget",onMouseEnter:()=>{parent.postMessage({type:"DECAGON_HOVER"},"*")},onMouseLeave:()=>{parent.postMessage({type:"DECAGON_UNHOVER"},"*")},onMouseOver:()=>{parent.postMessage({type:"DECAGON_HOVER"},"*")},style:{display:b?"none":"block"},children:[(0,i.jsx)(m,{cornerPosition:h,isWidgetHidden:b}),e.isHideable&&!l&&a&&(0,i.jsx)(f.Z,{onClick:()=>{r(!1),u({eventName:"DUET_WIDGET_HIDE"})},className:"absolute hover:scale-110 opacity-50",style:{left:"-12px",transition:"transform .3s"}}),(0,i.jsx)(p,{namespace:e.namespace,teamId:e.teamId,setMinimized:r})]})]})}},81230:function(e,t,a){var i,d;a.d(t,{$7:function(){return n},R$:function(){return s},gX:function(){return i}}),(d=i||(i={})).UNASSIGNED="Unassigned",d.REVIEW_REQUIRED="ReviewRequired",d.FIX_NEEDED="FixNeeded",d.RESOLVED="Resolved";let n=420,s=640}}]);